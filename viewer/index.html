<!DOCTYPE html>
<!-- Axel '0vercl0k' Souchet - December 16 2020 -->
<html>
<head>
  <title>Clairvoyance visualizer: virtual address space exploration</title>
  <script type='text/javascript' src='https://unpkg.com/panzoom@9.4.0/dist/panzoom.min.js'></script>
  <script type='text/javascript' src='./clairvoyance.js'></script>
  <script>

    //
    // Read a clairvoyance file.
    //

    function read(Input) {
      const File = Input.files[0];
      const Reader = new FileReader();
      Reader.onload = () => {
        const Canvas = document.getElementById('canvas');
        panzoom(Canvas);
        const ClickLog = document.getElementById('clicked');
        const MouseLog = document.getElementById('mouseover');
        const Clairvoyance = new Clairvoyance_t(Canvas, ClickLog, MouseLog);
        return Clairvoyance.parseFile(Reader.result);
      };

      Reader.onerror = () => {
        console.log(Reader.error);
      };

      Reader.readAsText(File);
    }
  </script>
</head>
<body style='background-color: black;'>
  <input type='file' onchange='read(this)' value='Upload a file'>
  <center>
    <div>
      <canvas id='canvas' width=0 height=0>
        Your browser does not support the HTML 5 Canvas.
      </canvas>
      <div id='clicked' style="font-family: 'Courier New', Courier, monospace; color: white;">Last clicked virtual address</div>
      <div id='mouseover' style="font-family: 'Courier New', Courier, monospace; color: white;">Last mouse-over'd virtual address</div>
    </div>
  </center>
</body>
</html>